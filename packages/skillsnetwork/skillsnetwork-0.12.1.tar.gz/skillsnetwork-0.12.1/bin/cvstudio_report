#!/usr/bin/env python3

import json
import argparse
import skillsnetwork.cvstudio

def report(data, token):
    cvstudio = skillsnetwork.cvstudio.CVStudio(token=token)

    result = cvstudio.report(**data)

    if result.ok:
        print('Congratulations your results have been reported back to CV Studio!')
    else:
        print('Failed to report results.')
        print(result.text)


parser = argparse.ArgumentParser(description='Send a Report to CV Studio')
parser.add_argument('-i', '--interactive', nargs='*', help='Interactive login prompt')
parser.add_argument('jsonFilename', nargs='+', help='Filename(s) of JSON files containing data to send to CV Studio')
args = parser.parse_args()

token=None
if args.interactive is not None:
    token = skillsnetwork.cvstudio.CVStudio.interactive()["token"]

for filename in args.jsonFilename:
    with open(filename) as f:
        data = json.load(f)

    report(data, token)
