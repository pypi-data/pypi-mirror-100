#!python

import json
import argparse
import skillsnetwork.cvstudio

def ping(token):
    cvstudio = skillsnetwork.cvstudio.CVStudio(token=token)

    result = cvstudio.ping()

    if result.ok:
        print('Congratulations you are connected to CV Studio!')
        item = json.loads(result.text)
        if 'trainingrun' in item:
            print('Training Run: ' + item['trainingrun']['name'])
        elif 'app' in item:
            print('Application: ' + item['app']['name'])
    else:
        print('Failed to contact CV Studio.')
        print(result.text)


parser = argparse.ArgumentParser(description='Ping CV Studio')
parser.add_argument('-i', '--interactive', nargs='*', help='Interactive login prompt')
args = parser.parse_args()

token=None
if args.interactive is not None:
    token = skillsnetwork.cvstudio.CVStudio.interactive()["token"]

ping(token)
